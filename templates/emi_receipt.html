{% extends "base.html" %}

{% block title %}EMI ‡¶∞‡¶∏‡¶ø‡¶¶ - {{ emi_ledger.id }}{% endblock %}

{% block content %}
<div class="row">
    <div class="col-md-8 mx-auto">
        <div class="card" id="receipt">
            <div class="card-header bg-success text-white text-center">
                <h3>EMI ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶∞‡¶∏‡¶ø‡¶¶</h3>
                <p class="mb-0">Showroom Manager</p>
            </div>
            <div class="card-body">
                <!-- Receipt Header -->
                <div class="row mb-4">
                    <div class="col-6">
                        <strong>‡¶∞‡¶∏‡¶ø‡¶¶ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞:</strong> #EMI-{{ emi_ledger.id }}<br>
                        <strong>‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ:</strong> {{ emi_ledger.updated_at.strftime('%d-%m-%Y %H:%M') }}
                    </div>
                    <div class="col-6 text-end">
                        <strong>‡¶¨‡¶ø‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞:</strong> #{{ emi_ledger.sale_id }}
                    </div>
                </div>

                <!-- Customer Details -->
                <div class="card mb-3">
                    <div class="card-header">
                        <strong>‡¶ï‡ßç‡¶∞‡ßá‡¶§‡¶æ‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø</strong>
                    </div>
                    <div class="card-body">
                        <strong>‡¶®‡¶æ‡¶Æ:</strong> {{ emi_ledger.sale.customer.name }}<br>
                        <strong>‡¶´‡ßã‡¶®:</strong> {{ emi_ledger.sale.customer.phone }}<br>
                        {% if emi_ledger.sale.customer.address %}
                        <strong>‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ:</strong> {{ emi_ledger.sale.customer.address }}<br>
                        {% endif %}
                    </div>
                </div>

                <!-- Product Details -->
                <div class="card mb-3">
                    <div class="card-header">
                        <strong>‡¶™‡¶£‡ßç‡¶Ø‡ßá‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø</strong>
                    </div>
                    <div class="card-body">
                        <strong>‡¶™‡¶£‡ßç‡¶Ø:</strong> {{ emi_ledger.sale.product.name }}<br>
                        <strong>‡¶Æ‡¶°‡ßá‡¶≤:</strong> {{ emi_ledger.sale.product.model }}<br>
                        <strong>‡¶Æ‡ßã‡¶ü ‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø:</strong> ‡ß≥{{ emi_ledger.sale.total_amount }}
                    </div>
                </div>

                <!-- Payment Details -->
                <div class="card bg-light mb-3">
                    <div class="card-header">
                        <strong>‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶¨‡¶ø‡¶¨‡¶∞‡¶£</strong>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <strong>‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶ï‡¶ø‡¶∏‡ßç‡¶§‡¶ø:</strong> ‡ß≥{{ emi_ledger.monthly_amount }}<br>
                                <strong>‡¶™‡¶∞‡¶ø‡¶∂‡ßã‡¶ß‡¶ø‡¶§ ‡¶ï‡¶ø‡¶∏‡ßç‡¶§‡¶ø:</strong> {{ emi_ledger.installments_paid }}/{{
                                emi_ledger.total_installments }}<br>
                            </div>
                            <div class="col-md-6">
                                <strong>‡¶Ö‡¶¨‡¶∂‡¶ø‡¶∑‡ßç‡¶ü ‡¶ï‡¶ø‡¶∏‡ßç‡¶§‡¶ø:</strong> {{ emi_ledger.total_installments -
                                emi_ledger.installments_paid }}<br>
                                <strong>‡¶Ö‡¶¨‡¶∂‡¶ø‡¶∑‡ßç‡¶ü ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£:</strong> ‡ß≥{{
                                "%.2f"|format(emi_ledger.calculate_remaining_amount()) }}<br>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Current Payment -->
                <div class="alert alert-success text-center">
                    <h4>‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü: ‡ß≥{{ emi_ledger.monthly_amount }}</h4>
                </div>

                <!-- Next Payment -->
                {% if emi_ledger.status == 'Active' %}
                <div class="alert alert-info text-center">
                    <strong>‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ:</strong> {{ emi_ledger.next_payment_date.strftime('%d-%m-%Y') }}
                </div>
                {% elif emi_ledger.status == 'Completed' %}
                <div class="alert alert-success text-center">
                    <i class="bi bi-check-circle-fill"></i>
                    <strong>‡¶∏‡¶Æ‡¶∏‡ßç‡¶§ ‡¶ï‡¶ø‡¶∏‡ßç‡¶§‡¶ø ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá! üéâ</strong>
                </div>
                {% endif %}

                <!-- Footer -->
                <div class="text-center mt-4">
                    <p class="text-muted">‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ß‡¶®‡ßç‡¶Ø‡¶¨‡¶æ‡¶¶!</p>
                    <hr>
                    <small class="text-muted">‡¶è‡¶á ‡¶∞‡¶∏‡¶ø‡¶¶‡¶ü‡¶ø ‡¶ï‡¶Æ‡ßç‡¶™‡¶ø‡¶â‡¶ü‡¶æ‡¶∞ ‡¶¶‡ßç‡¶¨‡¶æ‡¶∞‡¶æ ‡¶§‡ßà‡¶∞‡¶ø ‡¶è‡¶¨‡¶Ç ‡¶∏‡ßç‡¶¨‡¶æ‡¶ï‡ßç‡¶∑‡¶∞‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶® ‡¶®‡ßá‡¶á</small>
                </div>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="text-center mt-3 no-print">
            <button onclick="window.print()" class="btn btn-success">
                <i class="bi bi-printer"></i> ‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
            </button>
            <a href="{{ url_for('emi.dashboard') }}" class="btn btn-secondary">
                <i class="bi bi-arrow-left"></i> ‡¶°‡ßç‡¶Ø‡¶æ‡¶∂‡¶¨‡ßã‡¶∞‡ßç‡¶°‡ßá ‡¶´‡¶ø‡¶∞‡ßá ‡¶Ø‡¶æ‡¶®
            </a>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<style>
    @media print {
        .no-print {
            display: none !important;
        }

        nav,
        footer {
            display: none !important;
        }

        .container {
            max-width: 100% !important;
        }
    }
</style>
{% endblock %}